<html>

	<head>
		<title>SwiftAPI Specification</title>

		<style>
			body
				{
				font-family: sans-serif;
				color: #333;
				}

			table
				{
				border-collapse: collapse;
				}

			thead
				{
				background-color: LightSteelBlue;
				border-bottom: 3px double Gray;
				}

			td, th
				{
				border:1px solid Gray;
				padding: 0.2em;
				}
		</style>

	</head>

	<body>

		<h1>SwiftAPI Specification</h1>

		<h2>Version</h2>
		<p>3</p>

		<h2>Overview</h2>
		<p>This document details the operations, transfer method, fields, and encryption scheme used to implement the SwiftAPI.</p>

		<h2 id="Operations">Operations</h2>
		<table>
			<thead>
				<tr>
					<th>Operation</th>
					<th>Description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>home</td>
					<td>A user visits the website's homepage.</td>
				</tr>
				<tr>
					<td>product</td>
					<td>A user visits a product details page - a page that lists all information about a single product.</td>
				</tr>
				<tr>
					<td>cart</td>
					<td>A user adds products to the shopping cart.</td>
				</tr>
				<tr>
					<td>order</td>
					<td>A user successfully places an order on the website.</td>
				</tr>
				<tr>
					<td>pastorder</td>
					<td>When a client first sets up the plugin on their website it will send all historical order data to the Swift system, unless the client decides to opt out.</td>
				</tr>
				<tr>
					<td>subscription</td>
					<td>A user submits their email address to join a newsletter using Magento's standard newsletter subscription feature.</td>
				</tr>
				<tr>
					<td>viewmail</td>
					<td>A user accesses the website via a link in one of the Swift system's emails.</td>
				</tr>
				<tr>
					<td>sendmail</td>
					<td>The Swift system has generated an email to be sent by a clients site. <strong>Not</strong> for sending to the swift system, this is what is sent to the clients website.</td>
				</tr>
				<tr>
					<td>unsubscribe</td>
					<td>A user unsubscribes from the Swift system.</td>
				</tr>
				<tr>
					<td>ping</td>
					<td>To confirm to the Swift system the plugin is sending data.</td>
				</tr>
				<tr>
					<td>emailpackage</td>
					<td>Packages a group of emails to send to the clients website. <strong>Not</strong> for sending to the swift system, this is what is sent to the clients website.</td>
				</tr>
			</tbody>
		</table>

		<h2>Transfer Method</h2>
		<p>Requests to the API will be send via <strong>HTTPS POST</strong>.</p>

		<h2>POST Format</h2>
		<table>
			<thead>
				<tr>
					<th>Key</th>
					<th>Data Type</th>
					<th>Description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>version</td>
					<td>Integer</td>
					<td>The API version number.</td>
				</tr>
				<tr>
					<td>domain</td>
					<td>String</td>
					<td>The domain name of the SwiftCRM clients site.</td>
				</tr>
				<tr>
					<td>data</td>
					<td>String</td>
					<td>A <strong>base64</strong> encoded string containing an <strong>AES-256</strong> initialization vector followed by a <strong>AES-256</strong> encrypted <strong>JSON</strong> object comprised of the <a href="#DataFields">Data Fields</a> listed below.</td>
				</tr>
			</tbody>
		</table>

		<h2 id="DataFields">Data Fields</h2>
		<table>
			<thead>
				<tr>
					<th>Field</th>
					<th>Data Type</th>
					<th>Required for Operations</th>
					<th>Optional for Operations</th>
					<th>Description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>domain</td>
					<td>String</td>
					<td>ALL</td>
					<td></td>
					<td>The domain name of the SwiftCRM clients site. (This is required to be duplicated in the data section to prevent forged requests.)</td>
				</tr>
				<tr>
					<td>date</td>
					<td>String - <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO 8601 Date</a></td>
					<td>ALL</td>
					<td></td>
					<td>An ISO Date when the request was generated in the format YYYY-MM-DDThh:mm e.g. 2007-04-05T14:30</td>
				</tr>
				<tr>
					<td>operation</td>
					<td>String - <a href="#Operations">SwiftAPI Operation ID</a></td>
					<td>ALL</td>
					<td></td>
					<td>One of the <a href="#Operations">SwiftAPI operation ID's</a></td>
				</tr>
				<tr>
					<td>user</td>
					<td>String - <a href="http://en.wikipedia.org/wiki/Universally_unique_identifier">UUID</a></td>
					<td>ALL</td>
					<td></td>
					<td>A universally unique identifier generated by the SwiftCRM client site/plugin used to identify a user over the duration of their visit to a site.</td>
				</tr>
				<tr>
					<td>url</td>
					<td>String</td>
					<td>home</td>
					<td></td>
					<td>The URL of the page where the API request was triggered.</td>
				</tr>
				<tr>
					<td>email</td>
					<td>String</td>
					<td>order, pastorder, subscription, viewmail, sendmail, unsubscribe</td>
					<td>home, product, cart</td>
					<td>The users email address.</td>
				</tr>
				<tr>
					<td>forename</td>
					<td>String</td>
					<td>order, pastorder</td>
					<td></td>
					<td>The users forename.</td>
				</tr>
				<tr>
					<td>surname</td>
					<td>String</td>
					<td>order, pastorder</td>
					<td></td>
					<td>The users surname.</td>
				<tr>
					<td>product</td>
					<td>String</td>
					<td>product, viewmail</td>
					<td></td>
					<td>A site specific product identifier (Should correspond to ID's provided in the sites 'product XML file').</td>
				</tr>
				<tr>
					<td>products</td>
					<td>Array</td>
					<td>cart, order, pastorder</td>
					<td></td>
					<td>An array of JSON objects containing <a href="#ProductFields">Product Fields</a>.</td>
				</tr>
				<tr>
					<td>subject</td>
					<td>String</td>
					<td>sendmail</td>
					<td></td>
					<td>Message subject for a swift email.</td>
				</tr>
				<tr>
					<td>body</td>
					<td>String</td>
					<td>sendmail</td>
					<td></td>
					<td>Message content for a swift email.</td>
				</tr>
				<tr>
					<td>key</td>
					<td>String</td>
					<td>ping</td>
					<td></td>
					<td>The Swift system key recieved upon registration.</td>
				</tr>
				<tr>
					<td>monitor</td>
					<td>Boolean</td>
					<td>sendmail</td>
					<td></td>
					<td>A flag to indicate an email is being monitored.</td>
				</tr>
				<tr>
					<td>emailId</td>
					<td>String</td>
					<td>sendmail, viewmail</td>
					<td></td>
					<td>A unique identifier from Swift system for logging.</td>
				</tr>
				<tr>
					<td>emailPackage</td>
					<td>Array</td>
					<td>emailpackage</td>
					<td></td>
					<td>An array of JSON objects containing the fields sendmail required fields</td>
				</tr>
			</tbody>
		</table>

		<h2 id="ProductFields">Product Fields</h2>
		<table>
			<thead>
				<tr>
					<th>Field</th>
					<th>Data Type</th>
					<th>Description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>product</td>
					<td>String</td>
					<td>A site specific product identifier (Should correspond to ID's provided in the sites 'product XML file').</td>
				</tr>
				<tr>
					<td>quantity</td>
					<td>Integer</td>
					<td>The number of products in the order.</td>
				</tr>
				<tr>
					<td>price</td>
					<td>String</td>
					<td>The product price (May potentially differ from the value specified in the sites 'product XML file').</td>
				</tr>
			</tbody>
		</table>
		
		<h2>Transfer Methods</h2>
		<p>You can send the data string across different transfer methods such as SOAP. Here is an example request via JS:</p>
<pre>&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;
	window.onload = function()
	{
		// notice the version, domain and data attributes in the request
		var query = &quot;version=3&amp;domain=test_magento.clients.netready.biz&amp;data=ypyiyeQE8Ve3FGNySm9YQ2t%2BGFOnwzPrs3Eh%2Bo9bAu9BgnNVqEPSU%2FGt1CwwvV6WdezRSm%2FKp2OK7nt95A1oYLkIt7LPdA0mX%2F2pucHHoiriBtdL%2F4lAk%2BdE4T0i7VcXb4OKZWMczv7n2%2FMygvBD03w%2F1kVNFHWAlQGhDYP5fDg16%2FhKGHB6jUdRTfUavWR7GG8jIv2obzLZs%2FXVoO%2BSFyB6Q%2FGNJ1hNZBgkqb6Zq7%2ByyjpcVc20s%2FB1%2BmUPOqHPTklu6GINtwsxq4tFANU7OHL10nS8fcYVUuDAOfav98o%3D&quot;;
		var http;

		// IE7+, Firefox, Chrome, Opera, Safari.
		if(window.XMLHttpRequest)
			http=new XMLHttpRequest();

		// IE6, IE5.
		else
			http=new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);

		http.open(&quot;POST&quot;,&quot;//api.swiftcrm.net&quot;, true);

		http.setRequestHeader(&quot;Content-type&quot;, &quot;application/x-www-form-urlencoded&quot;);
		http.setRequestHeader(&quot;Content-length&quot;, query.length);
		http.setRequestHeader(&quot;Connection&quot;, &quot;close&quot;);

		http.onreadystatechange= function()
		{
			if (http.readyState==4 &amp;&amp; http.status==200)
				console.log(&quot;success&quot;);
		}

		http.send(query);
	}
&lt;/script&gt;</pre>

	</body>

</html>